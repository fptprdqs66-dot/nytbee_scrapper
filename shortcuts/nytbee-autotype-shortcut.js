(async()=>{const d=10,s=t=>new Promise(r=>setTimeout(r,t)),n=()=>{let a=new Date();return`${a.getFullYear()}${String(a.getMonth()+1).padStart(2,'0')}${String(a.getDate()).padStart(2,'0')}`},u=`https://nytbee.com/Bee_${n()}.html`,f=async()=>{try{let a=await fetch(u,{credentials:'omit'});if(!a.ok)throw new Error(`NYTBee responded with status ${a.status}`);return await a.text()}catch(e){let a=await fetch(`https://r.jina.ai/http://nytbee.com/Bee_${n()}.html`,{credentials:'omit'});if(!a.ok)throw new Error(`Unable to fetch NYTBee answers directly (${e}) or via proxy (${a.status}).`);return await a.text()}},x=h=>[...new Set([...new DOMParser().parseFromString(h,'text/html').querySelectorAll('#main-answer-list li')].map(a=>(a.textContent||'').trim().toLowerCase().replace(/[^a-z]/g,'')).filter(a=>a.length))],t=document.activeElement,i=t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement,c=!!t?.isContentEditable;if(!t||(!i&&!c))throw new Error('Focus the game input field before running this shortcut.');const k=(a,b)=>t.dispatchEvent(new KeyboardEvent(a,{key:b,bubbles:!0,cancelable:!0})),m=a=>{if(i){let b=t.selectionStart??t.value.length,e=t.selectionEnd??t.value.length;t.value=`${t.value.slice(0,b)}${a}${t.value.slice(e)}`;t.selectionStart=t.selectionEnd=b+a.length;t.dispatchEvent(new InputEvent('input',{bubbles:!0,data:a,inputType:'insertText'}));return}if(c)document.execCommand('insertText',!1,a)},p=()=>{k('keydown','Enter');if(i){t.dispatchEvent(new InputEvent('input',{bubbles:!0,data:null,inputType:'insertLineBreak'}));t.value=''}else if(c)document.execCommand('insertParagraph',!1);k('keyup','Enter')},w=async a=>{for(let b of a)k('keydown',b),k('keypress',b),m(b),k('keyup',b),await s(d);p();await s(d)},h=await f(),a=x(h);if(!a.length)throw new Error('No answers were extracted from the NYTBee page.');console.log(`Typing ${a.length} answers from ${u}`);for(let b of a)await w(b);console.log('Finished typing all answers.')})();
